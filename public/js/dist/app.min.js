!function(){var a=angular.module("app",["ngRoute"]);a.controller("MainCtrl",["$scope",function(a){}]),a.config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode({enabled:!0,requireBase:!1}),a.when("/",{templateUrl:"/js/app/htmlTemplates/movieListTemplate.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){var a=angular.module("app");a.factory("movieAPIServices",["$http","$q","routingConstants",function(a,b,c){var d=function(d,e,f){var g=b.defer(),h={};return h.list=d,h.page=e,h.q=f,a.get(c.moviesAPI,{params:h}).success(function(a,b,c,e,f){if(a){if(d&&d>0&&a.movies&&a.movies.length){d=a.movies.length<d?a.movies.length:d;for(var h=[],i=0;d>i;i++)h.push(a.movies[i]);a.movies=h}}else console.warn("Error in movieAPIServices _getAllMovies");g.resolve(a)}).error(function(a,b,c,d,e){404===b?(console.warn("No movies found."),g.reject(a,b)):(console.warn("Error in movieAPIServices _getAllMovies"),g.reject(a))}),g.promise};return{getAllMovies:d}}])}(),function(){var a=angular.module("app");a.constant("routingConstants",{url:"http://localhost",port:"8000",moviesAPI:"/api/movies"}),a.constant("commonConstants",{numberMoviesPageLoad:20})}(),function(){var a=angular.module("app");a.filter("filterActors",function(){return function(a){for(var b="",c=0;c<a.list.length;c++)a.list.length-1&&(b+=a.list[c].name+", ");return b}}),a.filter("filterDuration",function(){return function(a){var b=a/60;return b}})}(),function(){var a=angular.module("app");a.factory("movieModelServices",["$q","movieAPIServices","validationServices",function(a,b,c){var d=null,e=function(e,f,g,h){var i=a.defer();if(h&&d)i.resolve(d.movies);else{var j=c.validateInput(e,f);e=j.numberOfItemsToReturn,f=j.pageNumber,b.getAllMovies(e,f,g).then(function(a){a?(d=a,i.resolve(a)):console.warn("Error in movieModelServices _getAllMovies")},function(a,b){i.reject(a)})}return i.promise};return{getAllMovies:e}}])}(),function(){var a=angular.module("app");a.factory("validationServices",[function(){var a=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},b=function(b,c){if(void 0!==b&&!a(b))throw console.log(b),"Please provide valid integer for number of items to return.";if(b=1>b||void 0===b?1:b,b=parseInt(b),void 0!==c&&!a(c))throw console.log(c),"Please provide valid integer for page number.";return c=1>c||void 0===c?1:c,c=parseInt(c),{pageNumber:c,numberOfItemsToReturn:b}};return{validateInput:b,isNumeric:a}}])}(),function(){var a=angular.module("app");a.controller("movieListCtrl",["$scope","movieModelServices","commonConstants","paginatonService","validationServices",function(a,b,c,d,e){a.Title="Title1",a.movieList=[],a.searchPhrase="",a.pagination={},a.list=20,a.currentPage=1,a.finalPage=1,a.maxList=1,a.totalfilteredMovies=0,function(){b.getAllMovies(c.numberMoviesPageLoad).then(function(b){a.movieList=b.movies,a.list=c.numberMoviesPageLoad,a.pagination=d.Pagination(a.finalPage,a.currentPage)})}();var f=function(c,e,f,g){(a.searchPhrase.length>2||""===a.searchPhrase)&&b.getAllMovies(c,e,f).then(function(b){a.errorMessage&&(a.errorMessage=""),a.movieList=b.movies,f?(a.finalPage=Math.ceil(b.totalfilteredMovies/a.list),a.totalfilteredMovies=b.totalfilteredMovies):(a.totalfilteredMovies=b.totalMoviesCount,a.finalPage=Math.ceil(b.totalMoviesCount/a.list)),a.totalfilteredMovies<a.list&&(a.list=a.totalfilteredMovies),a.pagination=d.Pagination(a.finalPage,a.currentPage)},function(b){b.errorMessage&&(a.errorMessage=b.errorMessage,a.movieList=[])})};a.$watch("searchPhrase",function(b,d){d&&d.length&&d.length>0&&0===b.length&&(a.list=c.numberMoviesPageLoad),f(a.list,a.currentPage,b)}),a.$watch("list",function(b,c){1>b&&(a.list=1),a.searchPhrase&&a.searchPhrase.lenght&&a.searchPhrase.length>2&&a.list>a.totalfilteredMovies&&a.totalfilteredMovies>0&&(a.list=a.totalfilteredMovies),f(b,a.currentPage,a.searchPhrase)}),a.$watch("currentPage",function(b,c){return e.isNumeric(b)?1>b?void(a.currentPage=1):a.finalPage<b?void(a.currentPage=a.finalPage):void f(a.list,b,a.searchPhrase):void(a.currentPage=1)}),a.$watch("finalPage",function(b,c){b<a.currentPage&&(a.currentPage=b)}),a.$on("pagination:next",function(){a.currentPage++}),a.$on("pagination:previous",function(){a.currentPage--})}])}(),function(){var a=angular.module("app");a.directive("movieList",function(){return{restrict:"E",transclude:!0,controller:"movieListCtrl",link:function(a,b,c){},templateUrl:"js/app/modules/movieList/movieListView.html"}})}(),function(){function a(a,b,c){this.maxCount=a,this.counter=b,this.max=function(){return this.maxCount},this.current=function(){return this.counter},this.next=function(){this.hasNext()&&(this.counter++,c.$broadcast("pagination:next",this.counter))},this.previous=function(){this.hasPrevious()&&(this.counter--,c.$broadcast("pagination:previous",this.counter))},this.hasPrevious=function(){return this.counter>1},this.hasNext=function(){return this.counter<this.maxCount}}var b=angular.module("app");b.factory("paginatonService",["$rootScope",function(b){return{Pagination:function(c,d){return new a(c,d,b)}}}])}();