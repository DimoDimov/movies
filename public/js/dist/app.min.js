!function(){"use strict";self.appDep=self.appDep||{},self.appDep.Libs=angular.module("app.libs",["ngRoute"]),self.appDep.Constants=angular.module("app.constants",[]),self.appDep.Services=angular.module("app.services",[]),self.appDep.Filters=angular.module("app.filters",[]),self.appDep.Controllers=angular.module("app.controllers",[]),self.appDep.Directives=angular.module("app.directives",[]),self.appDep.Tests=angular.module("app.tests",["templates"]),self.appDep.AllDependencies=Neosavvy.AngularCore.Dependencies.concat(["app.libs","app.constants","app.services","app.filters","app.controllers","app.directives"]),self.appDep.TestDependencies=Neosavvy.AngularCore.Dependencies.concat(["app.libs","app.constants","app.services","app.filters","app.controllers","app.directives","app.tests"])}(),function(){"use strict";var a=angular.module("app",appDep.AllDependencies);a.controller("MainCtrl",["$scope",function(a){}]),a.config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode({enabled:!0,requireBase:!1}),a.when("/",{templateUrl:"/js/app/htmlTemplates/movieListTemplate.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";appDep.Services.factory("movieAPIServices",["$http","$q","routingConstants",function(a,b,c){var d=function(d,e,f){var g=b.defer(),h={};h.list=d,h.page=e,h.q=f;var i=c.url+":"+c.port+c.moviesAPI;return a.get(i,{params:h}).success(function(a,b,c,e,f){if(a){if(d&&d>0&&a.movies&&a.movies.length){d=a.movies.length<d?a.movies.length:d;for(var h=[],i=0;d>i;i++)h.push(a.movies[i]);a.movies=h}}else console.warn("Error in movieAPIServices _getAllMovies");g.resolve(a)}).error(function(a,b,c,d,e){404===b?(console.warn("No movies found."),g.reject(a,b)):(console.warn("Error in movieAPIServices _getAllMovies"),a.errorMessage="Server problems. Please try again later",g.reject(a))}),g.promise};return{getAllMovies:d}}])}(),function(){"use strict";appDep.Constants.constant("routingConstants",{url:"http://localhost",port:"8000",moviesAPI:"/api/movies"}),appDep.Constants.constant("commonConstants",{numberMoviesPageLoad:20})}(),function(){"use strict";appDep.Filters.filter("filterActors",["validationServices",function(a){return function(b){if(a.isObject(b)&&a.isArray(b.list)){for(var c="",d=0;d<b.list.length;d++)c+=d<b.list.length-1?b.list[d].name+", ":b.list[d].name;return c}return""}}]),appDep.Filters.filter("filterDuration",["validationServices",function(a){return function(b){if(a.isNumeric(b)){b=parseInt(b);var c=b/60;return c}return b}}])}(),function(){"use strict";appDep.Services.factory("movieModelServices",["$q","movieAPIServices","validationServices",function(a,b,c){var d=this;d.movieListCached=null;var e=function(e,f,g,h){var i=a.defer();if(h&&d.movieListCached)i.resolve(d.movieListCached);else{var j=c.validateInput(e,f);e=j.numberOfItemsToReturn,f=j.pageNumber,b.getAllMovies(e,f,g).then(function(a){a?(this.movieListCached=a,i.resolve(a)):(i.resolve(a),console.warn("Error in movieModelServices _getAllMovies"))}.bind(d),function(a,b){i.reject(a)})}return i.promise};return{getAllMovies:e}}])}(),function(){"use strict";appDep.Services.factory("validationServices",[function(){var a=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},b=function(a){return null!==a&&"object"==typeof a},c=function(a){return a&&a.constructor===Array},d=function(a){var b={};return a&&"[object Function]"===b.toString.call(a)},e=function(b,c){if(void 0!==b&&!a(b))throw console.warn(b),"Please provide valid integer for number of items to return.";if(b=1>b||void 0===b?1:b,b=parseInt(b),void 0!==c&&!a(c))throw console.warn(c),"Please provide valid integer for page number.";return c=1>c||void 0===c?1:c,c=parseInt(c),{pageNumber:c,numberOfItemsToReturn:b}};return{validateInput:e,isNumeric:a,isFunction:d,isArray:c,isObject:b}}])}(),function(){"use strict";appDep.Controllers.controller("movieListCtrl",["$scope","movieModelServices","commonConstants","validationServices",function(a,b,c,d){self=this,self.scope=a,a.movieList=[],a.searchPhrase="",a.errorMessage="",a.pagination={},a.list=c.numberMoviesPageLoad,a.currentPage=1,a.finalPage=1,a.totalfilteredMovies=a.list,a.totalMoviesCount=a.list,a.nextcallback=function(){self.scope.finalPage>self.scope.currentPage&&self.scope.currentPage++}.bind(self),a.previouscallback=function(){1<self.scope.currentPage&&self.scope.currentPage--}.bind(self);var e=function(){b.getAllMovies(c.numberMoviesPageLoad).then(function(b){a.movieList=b.movies||1,a.list=c.numberMoviesPageLoad,a.totalfilteredMovies=b.totalMoviesCount,a.totalMoviesCount=b.totalMoviesCount,a.finalPage=Math.ceil(b.totalMoviesCount/a.list)||1})};e();var f=function(b){b.errorMessage?a.errorMessage=b.errorMessage:a.errorMessage="",a.movieList=b.movies,a.totalMoviesCount=b.totalMoviesCount,a.searchPhrase?(a.totalfilteredMovies=b.totalfilteredMovies,a.finalPage=Math.ceil(b.totalfilteredMovies/a.list)||1):(a.totalfilteredMovies=b.totalMoviesCount,a.finalPage=Math.ceil(b.totalMoviesCount/a.list)||1),a.totalfilteredMovies<a.list&&(a.list=a.totalfilteredMovies||1)},g=function(b){b.errorMessage&&(a.errorMessage=b.errorMessage,a.movieList=[])},h=function(a,c,d,e){d.length<3&&(d=""),(d.length>2||""===d)&&b.getAllMovies(a,c,d).then(f,g)};a.$watch("searchPhrase",function(b,d){return b.length<3&&(a.list=c.numberMoviesPageLoad,a.errorMessage=""),d!==b?void h(a.list,a.currentPage,b,!1,"search"):void 0}),a.$watch("list",function(b,e){if(d.isNumeric(b)||(a.list=c.numberMoviesPageLoad),1>b&&(a.list=1),b>a.totalMoviesCount&&(a.list=a.totalMoviesCount||1),a.searchPhrase&&a.searchPhrase.length&&a.searchPhrase.length>2&&a.list>a.totalfilteredMovies&&a.totalfilteredMovies>0&&(a.list=a.totalfilteredMovies),e!==b){if(b&&e&&(b>a.totalfilteredMovies&&e===a.totalfilteredMovies||b>=a.totalfilteredMovies&&e>=a.totalfilteredMovies))return;h(a.list,a.currentPage,a.searchPhrase,!1,"list")}}),a.$watch("currentPage",function(b,c){return d.isNumeric(b)?1>b?void(a.currentPage=1):a.finalPage<a.currentPage?void(a.currentPage=a.finalPage):void(c!==b&&b<=a.finalPage&&c!==a.finalPage+1&&h(a.list,b,a.searchPhrase,!1,"currentPage")):void(a.currentPage=1)}),a.$watch("finalPage",function(b,c){a.finalPage<a.currentPage&&(a.currentPage=a.finalPage)})}])}(),function(){"use strict";appDep.Directives.directive("movieList",function(){return{restrict:"E",transclude:!0,controller:"movieListCtrl",link:function(a,b,c){},templateUrl:"js/app/modules/movieList/movieListView.html"}})}(),function(){"use strict";appDep.Controllers.controller("paginationCtrl",["$scope","paginationService",function(a,b){a.$watch("finalPage",function(c,d){a.pagination=b.Pagination(a.finalPage,a.currentPage,a.nextcallback,a.previouscallback)}),a.$watch("currentPage",function(c,d){a.pagination=b.Pagination(a.finalPage,a.currentPage,a.nextcallback,a.previouscallback)})}])}(),function(){"use strict";appDep.Directives.directive("paginationDir",[function(){return{restrict:"E",transclude:!0,controller:"paginationCtrl",scope:{nextcallback:"&",previouscallback:"&",finalPage:"=finalpage",currentPage:"=currentpage"},link:function(a,b,c){if(!c.nextcallback||!c.previouscallback)throw"You must provide nextcallback and previouscallback for pagination service"},templateUrl:"js/app/modules/pagination/paginationView.html"}}])}(),function(){"use strict";appDep.Services.factory("paginationService",["validationServices",function(a){var b=function(b,c,d,e){var f=b,g=c,h=this;if(h.nextcallback=d,h.previouscallback=e,!a.isFunction(h.nextcallback)||!a.isFunction(h.previouscallback))throw"Please provide a next and previous callback functions";h.max=function(){return f},h.current=function(){return g},h.next=function(){h.hasNext()&&(g++,d())},h.previous=function(){h.hasPrevious()&&(g--,h.previouscallback())},h.hasPrevious=function(){return g>1},h.hasNext=function(){return f>g}};return{Pagination:function(a,c,d,e){return new b(a,c,d,e)}}}])}();